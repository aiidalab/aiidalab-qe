<div id="guide-header">
  In this guide, you will learn how to model ferromagnetic materials and how to
  include Hubbard U corrections in your calculations. In this example, you will investigate the PDOS of CoO and analyze
  how the Hubbard U influences the electronic structure.
  <br>Click on <b>Step 1: Select structure</b> and follow the instructions to proceed.
</div>

<div id="structure-step">
  <div class="alert alert-success">
    <h4>Tasks</h4>
    <ol>
      <li>Click on the <b>From examples</b> tab</li>
      <li>Click on <b>Simple crystals</b></li>
      <li>Select <b>Cobalt oxide</b> from the dropdown list</li>
      <li>Click the <b>Confirm</b> button to proceed</li>
    </ol>
  </div>
</div>

<div id="configuration-step">
  <div class="alert alert-success">
    <h4>Tasks</h4>
    <ol>
      <li>Select <b>Structure as is</b> (in the interest of time, we skip the relaxation here)</li>
      <li>Open <b>step 2.1</b> for further instructions</li>
    </ol>
  </div>
</div>

<div id="properties-selection">
  Here we select the properties to calculate. Each property is associated with a
  workflow that will submit one or more calculations. In this guide, we will analyze the PDOS,
  since this will facilitate the understanding of the impact of the Hubbard U on the electronic structure.
  <div class="alert alert-success">
    <h4>Tasks</h4>
    <ol>
      <li>Check (activate) <b>Electronic projected density of states (PDOS)</b></li>
      <li>Open <b>step 2.2</b> for further instructions</li>
    </ol>
  </div>
</div>

<div id="basic-settings">
  <div class="alert alert-warning">
    <b>Note:</b> If running locally (for example, on the AiiDAlab demo server),
    we recommend selecting the <b>fast</b> protocol to reduce the computational
    cost.
  </div>
  <div class="alert alert-success">
    <h4>Tasks</h4>
    <ol>
      <li>Select the <b>fast</b> protocol</li>
      <li>Set <b>Magnetism</b> to <b>On</b>. Keep the <b>Electronic type</b> as metal
      (this is required since we want to determine the magnetization self-consistently. When setting to
      insulator, the app will inform you that this is only possible for claculations for which you
      fix the total magnetization of the unit cell.).
    </li>
      <li>
        Open the <b>Advanced settings</b> panel to set the initial magnetic moments and the Hubbard U values.
      </li>
      <!-- <li>Switch to the <b>Band structure</b> tab</li> -->
    </ol>
  </div>
</div>

<div id="advanced-settings">
  Here, we will define the initial magnetic moments and set the Hubbard U values.
  <div class="alert alert-success">
    <h4>Tasks</h4>
    <h5>Setup ferromagnetism</h5>
    When <b>Magnetism</b> is activated, the <b>Magnetization</b> subsection appears below.
    In this tutorial, you will set the <b>Initial magnetic moments</b> of the different elements.
    <b>Note:</b> In general, it is also possible to set the <b>Total magnetization</b> instead.
    <ol>
      <li>
        Set the initial magnetic moments (replacing the default ones) of <b>Co</b> to <b>3 &mu;<sub>B</sub></b> and <b>O</b>
        to <b>0.6 &mu;<sub>B</sub></b>.
      </li>
    </ol>
    <h5>Setup DFT+U</h5>
    <ol>
      <li>Enable Hubbard-U corrections by activating the <b>Define U values</b> checkbox.</li>
      <li>Define the U values for the different elements. Set U for <b>Co - 3d</b> to <b>6 eV</b> (we do not apply a U correction to O).</li>
      <li>Switch to the <b>PDOS</b> tab for some final fine-tuning</li>
    </ol>
  </div>
</div>

<div id="pdos-settings">
  <div class="alert alert-success">
    <h4>Tasks</h4>
    <ol>
      <li>
        Set <b>Energy grid step (eV)</b> to <b>0.03 eV</b>. We change this parameter here to reduce the computational costs.
      </li>
      <li>Click the <b>Confirm</b> button to proceed</li>
    </ol>
  </div>
</div>

<div id="submission-step">
  <p>
    In the submission step, we define the computational resources to be used in
    the calculations. The global resources are used to define resources across
    all workflow calculations. Optionally, you can override the resource
    settings for specific calculations.
  </p>
  <div class="alert alert-warning">
    <b>Warning:</b> If running locally (for example, on the AiiDAlab demo
    server), we recommend keeping nodes and CPUs at the default minimum of 1
    each.
  </div>
  <p>
    Once the resources are defined, we can optionally customize the workflow
    label (pre-filled according to the settings of steps 1 & 2), as well as
    provide a detailed description of the workflow. Once we are ready, we can
    submit the workflow.

    You first need to select which code (code executable + computer where this
    will run) to use for each step of the workflow. The Quantum ESPRESSO app
    should always install a local Quantum ESPRESSO executable that is sufficient
    for this tutorial, but you can setup additional codes installed on remote
    supercomputers. For more information on how to set up codes, please refer to the
    corresponding
    <a
      href="https://aiidalab-qe.readthedocs.io/howto/setup_computer_code.html#"
      target="_blank"
    >
      documentation</a
    >.
  </p>
  <div class="alert alert-success">
    <h4>Tasks</h4>
    <ol>
      <li>Check that the the default options in the "Global resources" panel are the expected ones.
        Specifically: select 1 node and 1 CPU for each of the codes. Unless you want to run elsewhere,
        use the default codes on the AiiDAlab server (ending with `@localhost`)
        that are available from the dropdown menus.</li>
      <li><b>(Optional)</b> customize the workflow label</li>
      <li><b>(Optional)</b> add a workflow description</li>
      <li>Click the <b>Submit</b> button to proceed</li>
    </ol>
    <div class="alert alert-warning">
      <b>Warning:</b> The workflow may take a moment to submit.
    </div>
  </div>
</div>


<div id="results-panel">
  Here in the results panel, each tab will open results pertaining to a specific
  calculation submitted by the workflow.
  <div class="alert alert-success">
    See further instructions below in the <b>Electronice PDOS</b> tab.
  </div>
</div>

<div id="electronic-structure-results">
  When results are available, the <b>Load results</b> button will become active allowing us to
  load the results from AiiDA.
  <div class="alert alert-success">
    <h4>Tasks</h4>
    <ol>
      <li>
        Once the calculation is complete, click on the
        <b>Load results</b> button to load the available results
      </li>
      <li>
        Select <b>Group by element (atomic species)</b> in <b>Atomic grouping</b> to get a top-level understanding of the
        electronic structure.
      </li>
      <li>
        Next, focus on the specific orbitals of Co in the spin-down channel. Select <b>Group by angular momentum</b> in <b>Orbital grouping</b>.
        Understand where the Co-3d (spin-down) states are located. To do so, double click on the Co-3d (spin-down) states in the legend. This will
        hide all the other states. To deselect, simply double click again.
      </li>
      <li> If you want to go in more detail, select <b>No grouping (each orbital separately)</b> in <b>Orbital grouping</b>.
        This will show you the contributions of all individual orbitals.
      </li>
    </ol>
  </div>
</div>

<div id="post-guide">
  <h4>Post-guide exercises</h4>
  <ol>
        <li>Follow the steps in the guide again, but this time, unset the Hubbard U or set it to 0.
          <ul>
            <li>What do you notice?</li>
            <li>What happens to the electronic states around the Fermi level?</li>
          </ul>
        </li>
        <li>
        <b>Optionally:</b> Follow the same steps as before, but this time, choose a different U value.
        Inspect the results and see how the U values influence the electronic structure.
      </li>
  </ol>
  We already provide some of these results in our examples. Check the <b>Download examples</b> on the landing page of the app.
  You can follow the instructions there to import the examples. Afterwards, you can inspect the results in your <b>Calculation history</b>.
</div>
